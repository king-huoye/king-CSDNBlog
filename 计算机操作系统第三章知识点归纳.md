# 处理机调度与死锁

## 处理机调度的层次和调度算法的目标

### 处理机调度的层次

- 高级调度（High Level Scheduling）

    高级调度又称长程调度或作业调度，它的调度对象是作业。

- 低级调度（Low Level Scheduling）

    低级调度又称为进程调度或短程调度，其所调度的对象是进程（或内核级线程）。

- 中级调度（Intermediate Scheduling）

    中级调度又称为内存调度。引入中级调度的主要目的是，提高内存利用率和系统吞吐量。

### 处理机调度算法的目标

- 处理机调度算法的共同目标
    - 资源利用率

        CPU的利用率=CPU有效工作时间/CPU有效工作时间+CPU空闲等待时间

    - 公平性
    - 平衡性
    - 策略强制执行
- 批处理系统的目标
    - 平均周转时间短
    - 系统吞吐量高
    - 处理及利用率高
- 分时系统的目标
    - 响应时间快
    - 均衡性
- 实时系统的目标
    - 截止时间的保证
    - 可预测性

## 作业与作业调度

### 批处理系统中的作业

- 作业和作业步
    - 作业（Job）
    - 作业步（Job Step）

        每一个加工步骤称为一个作业步。

- 作业控制块（Job Control Block，JCB）
- 作业运行的三个阶段和三种状态
    - 收容阶段
    - 运行阶段
    - 完成阶段

### 作业调度的主要任务

- 接纳多少个作业
- 接纳哪些作业

### 先来先服务（FCFS）和短作业优先（SJF）调度算法

- 先来先服务（first-come first-served，FCFS）调度算法
- 短作业优先（short job first，SJF）的调度算法
    - 短作业优先算法

        作业越短，其优先级越高

    - 短作业优先算法的缺点
        - 必须预知作业的运行时间
        - 对长作业非常不利，长作业的周转时间会明显的增长。更严重的是，该算法完全忽视作业的等待时间，可能使作业等待时间过长，出现饥饿现象
        - 在采用SJF算法时，人—机无法实现交互
        - 该调度算法完全未考虑作业的紧迫程度，故不能保证紧迫性作业能得到及时处理。

### 优先级调度算法和高响应比优先调度算法

- 优先级调度算法（priority-scheduling algorithm，PSA）
- 高响应比优先调度算法（Highest Response Ratio Next，HRRN）

    FCFS算法所考虑的只是作业的等待时间，而忽视了作业的运行时间。而 SJF算法正好与之相反，只考虑作业的运行时间，而忽视了作业的等待时间。

    优先级的变化规律可描述为： 优先权=等待时间+要求服务时间/要求服务时间 由于等待时间与服务时间之和就是系统对该作业的响应时间，故该优先级又相当于相应比Rp。 Rp=等待时间+要求服务时间/要求服务时间=响应时间/要求服务时间

## 进程调度

### 进程调度的任务、机制和方式

- 进程调度的任务
    - 保存处理机的现场信息
    - 按某种算法选取进程
    - 把处理器分配给进程
- 进程调度机制
    - 排队器
    - 分派器
    - 上下文切换器
- 进程调度方式
    - 非抢占方式（Nonpreemptive Mode）

        一旦把处理机分配给某进程后，就一直让它运行下去。

    - 抢占方式（Preemptive Mode）

        这种调度方式允许调度程序根据某种原则，去暂停某个正在执行的进程。

        - 优先权原则
        - 短进程优先原则
        - 时间片原则

### 轮转调度算法

- 轮转法的基本原理
    - 时间片
- 进程切换时机
- 时间片大小的确定

### 优先级调度算法

- 优先级调度算法的类型
    - 非抢占式优先级调度算法
    - 抢占式优先级调度算法：会导致低优先级进程饥饿
- 优先级的类型
    - 静态优先级
        - 进程类型
        - 进程对资源的需求
        - 用户要求
    - 动态优先级

### 多队列调度算法

设置多个进程就绪队列，每个队列的优先级标准不同，采用不同的调度算法
